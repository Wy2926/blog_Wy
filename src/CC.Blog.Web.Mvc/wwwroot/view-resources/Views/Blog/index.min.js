(function(){$(function(){function f(){location.reload(!0)}function o(n,t){abp.message.confirm(abp.utils.formatString(abp.localization.localize("AreYouSureWantToDelete","Blog"),t),function(t){t&&u.deleteArticle(n).done(function(){f()})})}var u=abp.services.app.blog,i=$("body"),n=$("#ArticleCreateModal"),t=n.find("form"),e=new RegExp("(^|&)edit=([^&]*)(&|$)"),r=window.location.search.substr(1).match(e);r!=undefined&&r.length>3&&$.ajax({url:abp.appPath+"Blog/EditArticleModal?articleId="+r[2],type:"POST",contentType:"application/html",success:function(n){$("#ArticleEditModal div.modal-content").html(n);$("#ArticleEditModal").attr("style","display: block; padding-left: 17px;")},error:function(){}});t.validate({});i.delegate("#RefreshButton","click",function(){f()});i.delegate(".delete-article","click",function(){var n=$(this).attr("data-article-id"),t=$(this).attr("data-article-title");o(n,t)});i.delegate(".edit-article","click",function(n){var t=$(this).attr("data-article-id");n.preventDefault();$.ajax({url:"Blog/EditArticleModal?articleId="+t,type:"POST",contentType:"application/html",success:function(n){$("#ArticleEditModal div.modal-content").html(n)},error:function(){}})});t.find('button[type="submit"]').click(function(i){if(i.preventDefault(),t.valid()){var r=t.serializeFormToObject();r.ArticleStrTags=r.ArticleStrTags.replace(/,/ig,"，").split("，");r.html=editorCreate.txt.html();abp.ui.setBusy(n);u.articleCreateOrUpdate(r).done(function(){n.modal("hide");location.reload(!0)}).always(function(){abp.ui.clearBusy(n)})}});n.on("shown.bs.modal",function(){n.find("input:not([type=hidden]):first").focus()})})})();