(function(){$(function(){function r(){location.reload(!0)}function u(n,t){abp.message.confirm(abp.utils.formatString(abp.localization.localize("AreYouSureWantToDelete","Blog"),t),function(t){t&&i.deleteFriendshipLink(n).done(function(){r()})})}var i=abp.services.app.blog,n=$("#FriendshipLinkCreateModal"),t=n.find("form");t.validate({});$("#RefreshButton").click(function(){r()});$(".delete-friendshipLink").click(function(){var n=$(this).attr("data-friendshipLink-id"),t=$(this).attr("data-friendshipLink-title");u(n,t)});$(".edit-friendshipLink").click(function(n){var t=$(this).attr("data-friendshipLink-id");n.preventDefault();$.ajax({url:abp.appPath+"Blog/EditFriendshipLinkModal?linkId="+t,type:"POST",contentType:"application/html",success:function(n){$("#FriendshipLinkEditModal div.modal-content").html(n)},error:function(){}})});$("button[data-link-toExamine]").click(function(){var e=$(this).attr("data-link-id"),u=$(this).attr("data-link-title"),t=$(this).attr("data-link-toExamine"),f="未通过",r="不通过审核",n;t=="1"&&(r="通过审核",f="已通过");n=$(this);abp.message.confirm(abp.utils.formatString(abp.localization.localize("你确定友链 {0} {1}","Blog"),u,r),function(o){o&&i.friendshipLinkToExamine(e,t).done(function(){n.removeAttr("class");n.addClass("btn");t=="1"?(n.attr("data-link-toExamine",2),n.addClass("btn-success")):(n.attr("data-link-toExamine",1),n.addClass("btn-danger"));n.siblings().remove();n.text(f);abp.message.success(abp.utils.formatString(abp.localization.localize("友链：{0} 已确定 {1}","Blog"),u,r),"审核完成")})})});t.find('button[type="submit"]').click(function(r){if(r.preventDefault(),t.valid()){var u=t.serializeFormToObject();abp.ui.setBusy(n);i.friendshipLinkCreateOrUpdate(u).done(function(){n.modal("hide");location.reload(!0)}).always(function(){abp.ui.clearBusy(n)})}});n.on("shown.bs.modal",function(){n.find("input:not([type=hidden]):first").focus()})})})();